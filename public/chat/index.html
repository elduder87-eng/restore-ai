<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Restore AI — Teacher Mode</title>

<style>
body{
  font-family:Arial;
  background:#f1f3f5;
  margin:0;
}

.header{
  background:#0f172a;
  color:white;
  padding:14px;
  text-align:center;
  font-weight:bold;
}

.container{
  max-width:900px;
  margin:30px auto;
  background:white;
  padding:20px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
}

.chat{
  height:400px;
  overflow-y:auto;
  border:1px solid #ddd;
  padding:10px;
  margin-bottom:10px;
}

.user{
  color:#2563eb;
  margin:8px 0;
}

.ai{
  color:#111;
  margin:8px 0;
}

.inputRow{
  display:flex;
}

input{
  flex:1;
  padding:10px;
}

button{
  padding:10px 16px;
  background:#2563eb;
  color:white;
  border:none;
}
</style>
</head>

<body>

<div class="header">Restore AI — Teacher Mode</div>

<div class="container">
  <div id="chat" class="chat"></div>

  <div class="inputRow">
    <input id="input" placeholder="Ask a question..." />
    <button onclick="send()">Send</button>
  </div>
</div>

<script>
let history = JSON.parse(localStorage.getItem("restoreHistory") || "[]");

const chatDiv = document.getElementById("chat");

function renderHistory(){
  chatDiv.innerHTML = "";
  history.forEach(m=>{
    const div=document.createElement("div");
    div.className = m.role === "user" ? "user" : "ai";
    div.innerText =
      (m.role==="user" ? "You: " : "Restore AI: ") + m.content;
    chatDiv.appendChild(div);
  });
}

renderHistory();

async function send(){
  const input=document.getElementById("input");
  const message=input.value.trim();
  if(!message) return;

  history.push({role:"user",content:message});
  renderHistory();
  input.value="";

  const res=await fetch("/api/chat",{
    method:"POST",
    headers:{ "Content-Type":"application/json"},
    body:JSON.stringify({
      message,
      history
    })
  });

  const data=await res.json();

  history.push({
    role:"assistant",
    content:data.reply
  });

  localStorage.setItem("restoreHistory",JSON.stringify(history));

  renderHistory();
  chatDiv.scrollTop=chatDiv.scrollHeight;
}
</script>

</body>
</html>
